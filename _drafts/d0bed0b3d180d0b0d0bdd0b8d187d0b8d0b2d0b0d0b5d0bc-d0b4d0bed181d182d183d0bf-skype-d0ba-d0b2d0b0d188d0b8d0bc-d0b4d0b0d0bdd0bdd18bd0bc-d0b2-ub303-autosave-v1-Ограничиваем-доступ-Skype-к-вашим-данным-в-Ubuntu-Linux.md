---
id: 305
title: 'Ограничиваем доступ Skype к вашим данным в Ubuntu Linux'
date: '2013-08-16T17:00:53+03:00'
author: 'Андрей Гуцу'
layout: revision
guid: 'http://blog.lordofgale.org/2013/08/303-autosave/'
permalink: '/?p=305'
---

<h2> Вступление </h2>
<p>Вы доверяете Skype? Даже после того, как Сноуден открыл миру правду о сотрудничестве Microsoft со спецслужбами? Я, лично, нет. И вам не советую. Как работает Skype - знают только его создатели. Ни один авторитетный специалист по безопасности не имел возможность провести ревью кода данного продукта.</p>

<p>Для вашей же безопасности, хранящиеся на вашем ПК файлы лучше оградить от Skype. В Ubuntu имеется встроенный механизм безопасности. Он базируется на профилях безопасности для приложений, в которых правила описывают разрешение на совершение того, или иного, действия. В режиме complain данный механизм только наблюдает за приложениями, а в режиме enforce ограничивает их поведение рамками правил, описанных в профилях для каждого, взятого под наблюдение, приложения. Этот чудесный механизм называется AppArmor.</p>

<h2>Настройка AppArmor</h2>
<p>Что-бы настроить AppArmor для ограничения доступа Skype к вашим файлам следует сделать следующее:</p>
<h3>Установка apparmor-profiles</h3>
Установите пакет apparmor-profiles(командой sudo apt-get install apparmor-profiles), или через Software Center.
<h3> Проверка статуса AppArmor </h3>
Проверьте, работает ли у вас AppArmor командой
<pre>
<code class='bash'>
sudo apparmor_status
</code>
</pre>
<h3>Создание профиля с правилами для Skype</h3>
<p>Скопируйте файл <i>/usr/share/doc/apparmor-profiles/extras/usr.bin.skype</i> в <i>/etc/apparmor.d/usr.bin.skype</i> командой:
<pre>
<code class='bash'>
sudo cp /usr/share/doc/apparmor-profiles/extras/usr.bin.skype /etc/apparmor.d/usr.bin.skype
</code>
</pre>
</p>

<p>Откройте <i>/etc/apparmor.d/usr.bin.skype</i> в текстовом редакторе:
<pre>
<code class='bash'>
sudo gedit /etc/apparmor.d/usr.bin.skype
</code>
</pre>

</p><p>И в конец добавьте несколько строк:
<pre>
<code class='bash'>
  #Write and read in Downloads
  owner @{HOME}/Downloads krw,
  owner @{HOME}/Downloads/* krw,
  owner @{HOME}/Downloads/**/* krw,
</code>
</pre>

</p><p>Эти строки позволяют Skype сохранять присылаемые вам файлы в каталог Downloads, и его подкаталоги. И загружать файлы кому-то из данного каталога. Доступ ко всем другим каталогам в вашей домашней директории будет запрещён(если профиль будет работать в режиме enforce).</p>

<p>Так же вы можете открыть доступ на чтение(r), запись(w), или блокировку файла(k) к любой директории, просто добавив строки вида:
<pre>
<code class='bash'>
< владелец> < путь к директории> < права>,
</code>
</pre>
в ваш  <i>/etc/apparmor.d/usr.bin.skype</i>. К примеру, разрешаем Skype доступ ко всем файлам в директории Documents вашего домашнего каталога:</p>
<pre>
<code class='bash'>
owner @{HOME}/Documents/** krw,
</code>
</pre>
<p>После того, как вы настроите права доступа к каталогам и файлам для Skype, используйте команду <b>sudo aa-complain</b> для активации наблюдения за Skype(все нарушения правил будут зафиксированы, так что вы сможете принять решение, стоит ли перевести профиль Skype в режим enforce):
<pre>
<code class='bash'>
sudo aa-complain /etc/apparmor.d/usr.bin.skype
</code>
</pre>
</p>
<p>Если вы узнаете, что приложение нарушает правила, просто включите режим enforce, и оно лишится такой возможности:
<pre>
<code class='bash'>
sudo aa-enforce /etc/apparmor.d/usr.bin.skype
</code>
</pre>
</p>
<p>На всякий случай перезапустите все правила командой:
<pre>
<code class='bash'>
sudo invoke-rc.d apparmor reload
</code>
</pre>
</p>
<h3> Узнаём о нарушениях правил приложением, за которым ведётся наблюдение силами AppArmor</h3>
<p>На случай, если вы запустили наблюдение на каким-то из приложений(режим complain), вы всегда можете узнать нарушениях правил при помощи программы <b>aa-logprof</b>. Вызовите её командой:
<pre>
<code class='bash'>
sudo aa-logprof
</code>
</pre>
</p>
<p>Программа покажет все случаи доступа к файлам, не разрешённые правилами профиля приложения в AppArmor. И спросит, разрешать или запрещать в дальнейшем этой программе доступ к данным файлам? Получив ваши ответы, программа добавит их в профили для программ-нарушителей. Что удобно, постепенно вы можете добавляя нужные разрешения, существенно улучшить профиль AppArmor для любого приложения. Именно по этому я советую вначале погонять приложение с профилем complain, выявить какие файлы ему нужны для работы, к каким директориям и файлам вы хотите дать ему доступ, и только потом переводить профиль данного приложения в режим <i>enforce</i>.
</p>
<h2>Заключение</h2>
<p>Примите мои поздравления:) Теперь вы можете быть спокойны за свои данные, ведь теперь Skype у вас под наблюдением. А если вы приняли верное решение - то и с ограниченным доступом ко всем директориям(кроме тех, к которым вы открыли ему доступ). Думаю, подобный подход стоит распространить и на другие уязвимые программные решения.</p>
<p>P.S.: В данной статье я не в коем случае не намекаю на то, что Skype или любая другая проприетарная программа, следит за вами. Я так-же не призываю вас безоговорочно доверять открытому ПО. Я всего-лишь хочу напомнить, что безопасность лишней не бывает. И призвать вас использовать замечательный механизм обеспечения безопасности, встроенный в ваш дистрибутив Linux. В следующий раз я расскажу, как использовать подобный механизм в Fedora Linux.</p>