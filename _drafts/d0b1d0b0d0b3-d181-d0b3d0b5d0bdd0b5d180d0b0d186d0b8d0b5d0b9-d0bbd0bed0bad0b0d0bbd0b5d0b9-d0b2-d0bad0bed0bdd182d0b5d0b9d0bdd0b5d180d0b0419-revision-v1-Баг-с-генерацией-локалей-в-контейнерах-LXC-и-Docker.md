---
id: 421
title: 'Баг с генерацией локалей в контейнерах LXC и Docker'
date: '2014-09-25T19:32:30+03:00'
author: 'Андрей Гуцу'
layout: revision
guid: 'http://www.glowingsword.ru/2014/09/419-revision-v1/'
permalink: '/?p=421'
---

Столкнулся с ошибкой 

ru_RU.UTF-8...cannot change mode of new locale archive: No such file or directory done

в контейнерах Docker. Ошибка проявляется как на контейнерах на базе Debian и Ubuntu, так и в контейнерах на базе Centos и Fedora. Виновником данной проблемы оказался AppArmor на хосте, на котором запускались контейнеры. Достаточно остановить AppArmor, и проблема перестаёт проявляться. Поиск в багзиле Ubuntu быстро привел к тикету на https://bugs.launchpad.net/ubuntu/+source/langpack-locales/+bug/931717 Что интересно, баг был подтверждён в 2012 году, но до сих пор не исправлен.

В качестве временного решения данной проблемы можно просто отключать на время AppArmor, а после создания нужного образа снова включать AppArmor. Надеюсь, разработчики со временем решат данную проблему, и такие пляски с бубном вокруг AppArmor уйдут в небытие.

