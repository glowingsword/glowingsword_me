---
id: 242
date: '2013-02-07T17:40:46+02:00'
author: 'Андрей Гуцу'
layout: revision
guid: 'http://blog.lordofgale.org/2013/02/237-revision-2/'
permalink: '/?p=242'
---

В сети прошёл слух о уязвимостях, отрытых в реализациях протокола uPnP. Вот лишь некоторые производители, устройства которых подвержены данной уязвимости:

<ul>
  <li>Broadcom</li>
  <li>Asus</li>
  <li>Cisco</li>
  <li>TP-Link</li>
  <li>Zyxel</li>
  <li>D-Link</li>
  <li>Netgear</li>
  <li>US Robotics</li>
</ul>

Данная уязвимость позволяем злоумышленникам атаковать устройство посылкой специально сформированных пакетов. Что позволяет злоумышленнику атаковать ваш маршрутизатор(рутер) и любое другое устройство с поддержкой uPnP, запустив на данном устройстве произвольный код. Что-бы не быть оказаться среди тех, чья сеть оказалась в руках злоумышленников, всем Ъ рекомендуется срочно проверить свои маршрутизаторы, NAS, медиа-серверы и прочие девайсы с поддержкой uPnP.

Для проверки на уязвимость качаем пакет для поиска сетевых уязвимостей Metasploit.
Для начала установим нужные ему зависимости:

<pre><code class="bash">sudo apt-get install -y git ruby</code></pre>

Теперь клонируем самый свежий metasploit из официального репозитория(хранилища git):

<pre><code class="bash">git clone https://github.com/rapid7/metasploit-framework.git</code></pre>

Переходим в нужную директорию:

<pre><code class="bash">cd metasploit-framework</code></pre>

И запускаем сканнер:

<pre><code class="bash">./msfconsole</code></pre>

Видим что-то вроде этого:

<a href="http://blog.lordofgale.org/wp-content/uploads/2013/02/Screenshot-from-2013-02-07-170739.png"><img src="http://blog.lordofgale.org/wp-content/uploads/2013/02/Screenshot-from-2013-02-07-170739-300x198.png" alt="Screenshot from 2013-02-07 17:07:39" width="300" height="198" class="aligncenter size-medium wp-image-238" /></a>

Вводим команды, ответственные за поик нужных уязвимостей:
<pre><code class="bash">
msf > use auxiliary/scanner/upnp/ssdp_msearch
msf auxiliary(ssdp_msearch) > set RHOSTS 192.168.0.0/24
msf auxiliary(ssdp_msearch) > run
</code></pre>

Где 192.168.0.0/24 - сетка, которой управляет ваш маршрутизатор. У вас их может быть несколько. У меня это 192.168.1.0/24 и 192.168.3.0/24. По умолчанию маршрутизаторы обычно имеют адрес 192.168.1.1 - так что для большинства домашних сетей с одним маршрутизатором нужно всего лишь проверить сеть 192.168.1.0/24. Если у вас несколько маршрутизаторов/сетей - проверьте их все, на всякий случай. Помните, что самопальный маршрутизатор на основе сервачка с Linux на борту тоже подвержен данной уязвимости.

Как видите, у меня всё чисто. Тем, у кого найдётся что-то из этого списка уязвимостей:
<ol>
<li>CVE-2012-5958</li>
<li>CVE-2012-5959</li>
<li>CVE-2012-5960</li>
<li>CVE-2012-5961</li>
<li>CVE-2012-5962</li>
<li>CVE-2012-5963</li>
<li>CVE-2012-5964</li>
<li>CVE-2012-5965</li>
<li>CVE-2013-0229</li>
<li>CVE-2013-0230</li>
</ol>

следует срочно обновить прошивку своего девайса, переустановить ПО отвечающее за uPnP на сервере, или отрубить uPnP если производитель ПО для вашег устройства ещё не выпустил обновлений.

<a href="http://blog.lordofgale.org/wp-content/uploads/2013/02/Screenshot-from-2013-02-07-171601.png"><img src="http://blog.lordofgale.org/wp-content/uploads/2013/02/Screenshot-from-2013-02-07-171601-300x198.png" alt="Screenshot from 2013-02-07 17:16:01" width="300" height="198" class="aligncenter size-medium wp-image-239" /></a>

Данные уязвимости меня обошли стороной(спасибо разработчикам OpenWRT за качественную прошивку моего TP-LINK WR-740N). Помните: забота о безопасноти - это не пранойя. Грамотный подход к обеспечению вашей безопасности в сфере IT может сильно снизить риски по потере личной или деловой информации. Проверяйте вашу сеть на уязвимые места регулярно, и этим вы сильно затрудните жизнь злоумышленников.

При составлении данного поста автор использовал следующие материалы:
<a href="http://habrahabr.ru/post/168613/">Критическая уязвимость во многих роутерах различных вендоров</a>
<a href="http://nikmy.ru/index.php/stati/hacking/programmy-vzlom-programm/133-ustanovka-metasploit-v-ubuntu-12-04-debian.html">Установка Metasploit в Ubuntu 12.04 / Debian</a>
