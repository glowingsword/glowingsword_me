---
id: 204
title: 'Создание grub.cfg без использования скриптов, генерирующих данный файл'
date: '2013-01-01T17:44:25+02:00'
author: 'Андрей Гуцу'
layout: post
guid: 'http://blog.lordofgale.org/?p=204'
permalink: /204/
categories:
    - grub2
    - linux
    - 'создание загрузочной флешки'
tags:
    - grub2
    - linux
---

<p>Решив создать себе загрузочную флешку, и не горя желанием воспроизводить для создания одного файла grub.cfg всю инфраструктуру по генерации конфигурационного файла для grub2(основанную на куче скриптов), я принял решение создать grub.cfg ручками. В обычном текстовом редакторе.</p>
<p>Что обязательно должно быть в файле конфигурации GRUB2?</p>
<p>Пункт меню, выбранный по умолчанию и задержка(в секундах) перед загрузкой пункта,  выбранного по умолчанию. Если пользователь переходит к другому пункту меню, отсчёт таймера останавливается. Для указания пункта, загружаемого по умолчанию и задержки перед автоматической загрузкой, добавьте в grub.cfg эти строки:</p>
<pre>
<code class="bash">
set default="0"
set timeout=10
</code>
</pre>
<p>Для указания шрифта, используемого grub2 укажите путь к файлу этого шрифта в формате pf2. Файлы шрифтов для grub2 можно найти в директории /usr/share/grub, откуда можно скопировать нужный шрифт в каталог /boot/grub/fonts(если его там у вас нет, конечно). У меня это путь к unicode.pf2, благодаря которому можно использовать в том числе и символы кириллического алфавита. Добавьте в файл grub.cfg строку:</p>
<pre>
<code class="bash">
set font="/boot/grub/fonts/unicode.pf2"
</code>
</pre>
<p>Теперь нужно указать цвет фона для обычного и подсвеченного(выбранного) пункта меню. Делается это заданием двум переменным значений цветов фона и цвета шрифта. В первом случае(не подсвеченный пункт меню) цвет текста будет белым, на чёрном фоне. Для подсвеченного пункта меню я выбрал чёрный текст на светло-сером фоне. Добавляем в grub.cfg следующие строки:</p>
<pre>
<code class="bash"> 
set menu_color_normal=white/black
set menu_color_highlight=black/light-gray
</code>
</pre>
<p>Ну, и напоследок, создадим два пункта для нашего меню: перезагрузка и выключение компьютера:</p>
<pre>
<code class="bash">
menuentry "Shutdown the Computer" {
    halt
}

menuentry "Reboot the Computer" {
    reboot
}
</code>
</pre>
<p>Ну, и конечно-же вам хочется глянуть на результат. Вот он:</p>
<a href="https://glowingsword.ru/wp-content/uploads/2013/01/Screenshot-from-2012-12-31-151708.png"><img src="https://glowingsword.ru/wp-content/uploads/2013/01/Screenshot-from-2012-12-31-151708-300x178.png" alt="Screenshot from 2012-12-31 15:17:08" width="300" height="178" class="aligncenter size-medium wp-image-205" /></a>
<p>В следующей записи я покажу, как добавить в grub.cfg код, устанавливающий графический режим, разрешение и фоновую картинку для нашего меню.</p>
